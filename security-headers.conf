# Security Headers Configuration for All Is Well Hospital
# This file contains the recommended security headers for production

# Content Security Policy (CSP) with strict policy
# Includes nonce-based or hash-based script policy
# Allows required domains only (self, Google Fonts, YouTube, Tawk.to)
# Includes frame-ancestors, require-trusted-types-for 'script', trusted-types default
<IfModule mod_headers.c>
    # Content Security Policy
    Header always set Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://www.googletagmanager.com https://www.google-analytics.com https://www.google.com https://www.gstatic.com https://apis.google.com https://embed.tawk.to https://www.youtube.com https://www.youtube-nocookie.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: https:; media-src 'self' blob: data: https:; connect-src 'self' https://*.alliswellhospital.in https://www.google-analytics.com https://*.tawk.to https://www.googletagmanager.com; frame-src 'self' https://www.youtube.com https://www.youtube-nocookie.com https://embed.tawk.to https://www.google.com; frame-ancestors 'self' https://www.alliswellhospital.in; require-trusted-types-for 'script'; trusted-types default;"

    # Strict Transport Security
    Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"

    # Cross-Origin-Opener-Policy
    Header always set Cross-Origin-Opener-Policy "same-origin"

    # Cross-Origin-Embedder-Policy (if needed)
    Header always set Cross-Origin-Embedder-Policy "require-corp"

    # X-Frame-Options (redundant with CSP frame-ancestors but added for compatibility)
    Header always set X-Frame-Options "DENY"

    # X-Content-Type-Options
    Header always set X-Content-Type-Options "nosniff"

    # X-XSS-Protection
    Header always set X-XSS-Protection "1; mode=block"

    # Referrer-Policy
    Header always set Referrer-Policy "strict-origin-when-cross-origin"

    # Permissions-Policy (disable unused APIs)
    Header always set Permissions-Policy "geolocation=(), microphone=(), camera=(), payment=(), usb=(), serial=(), bluetooth=(), fullscreen=(self), accelerometer=(), ambient-light-sensor=(), autoplay=(), battery=(), document-domain=(), encrypted-media=(), execution-while-not-visible=(), execution-while-out-of-viewport=(), focus-without-user-activation=(), fullscreen=(), gamepad=(), geolocation=(), gyroscope=(), hid=(), idle-detection=(), magnetometer=(), microphone=(), midi=(), navigation-override=(), payment=(), picture-in-picture=(), publickey-credentials-get=(), screen-wake-lock=(), shared-autofill=(), sync-script=(), sync-xhr=(), trust-token-redemption=(), usb=(), vertical-scroll=(), web-share=(), xr-spatial-tracking=(), clipboard-read=(), clipboard-write=(), interest-cohort=()"

    # Feature-Policy (alternative to Permissions-Policy)
    Header always set Feature-Policy "geolocation 'self'; microphone 'self'; camera 'self'; payment 'self'; usb 'self'; serial 'self'; bluetooth 'self'; fullscreen 'self'; accelerometer 'self'; ambient-light-sensor 'self'; autoplay 'self'; battery 'self'; document-domain 'self'; encrypted-media 'self'; execution-while-not-visible 'self'; execution-while-out-of-viewport 'self'; focus-without-user-activation 'self'; fullscreen 'self'; gamepad 'self'; gyroscope 'self'; hid 'self'; idle-detection 'self'; magnetometer 'self'; microphone 'self'; midi 'self'; navigation-override 'self'; picture-in-picture 'self'; publickey-credentials-get 'self'; screen-wake-lock 'self'; shared-autofill 'self'; sync-script 'self'; sync-xhr 'self'; trust-token-redemption 'self'; vertical-scroll 'self'; web-share 'self'; xr-spatial-tracking 'self'; clipboard-read 'self'; clipboard-write 'self'; interest-cohort 'self'"
</IfModule>

# Additional security headers
<IfModule mod_headers.c>
    # Security headers for modern browsers
    Header always set X-Permitted-Cross-Domain-Policies "none"
    Header always set Expect-CT "max-age=86400, enforce"
    Header always set Clear-Site-Data '"cache", "cookies", "storage", "executionContexts"'
    Header always set Server "Apache"
</IfModule>
